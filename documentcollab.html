<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CollabDoc - Microsoft Style Collaboration</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2564cf;
            --secondary: #d0d0d0;
            --accent: #a4373a;
            --light: #f8f9fa;
            --dark: #252526;
            --gray: #5f6368;
            --border: #dadce0;
            --ribbon-bg: #f3f3f3;
            --ribbon-border: #e5e5e5;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--dark);
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }
        
        header {
            background-color: white;
            padding: 0 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            height: 48px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo h1 {
            font-size: 16px;
            font-weight: 500;
            color: var(--primary);
        }
        
        .logo-icon {
            color: var(--primary);
            font-size: 20px;
        }
        
        .header-actions {
            display: flex;
            gap: 16px;
            align-items: center;
        }
        
        .btn {
            padding: 6px 12px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2156b1;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--border);
            color: var(--gray);
        }
        
        .btn-outline:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--gray);
            font-size: 13px;
        }
        
        .avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
        }
        
        /* Ribbon Menu */
        .ribbon {
            background-color: var(--ribbon-bg);
            border-bottom: 1px solid var(--ribbon-border);
            padding: 0 16px;
            display: flex;
            height: 40px;
            align-items: center;
        }
        
        .ribbon-tabs {
            display: flex;
            gap: 4px;
        }
        
        .ribbon-tab {
            padding: 6px 12px;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
            font-size: 13px;
            color: var(--gray);
        }
        
        .ribbon-tab.active {
            background-color: white;
            border: 1px solid var(--ribbon-border);
            border-bottom: none;
            color: var(--primary);
            font-weight: 500;
        }
        
        .ribbon-content {
            display: none;
            background-color: white;
            border-bottom: 1px solid var(--ribbon-border);
            padding: 12px 16px;
            height: 80px;
        }
        
        .ribbon-content.active {
            display: flex;
            gap: 16px;
        }
        
        .ribbon-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
            padding-right: 16px;
            border-right: 1px solid var(--ribbon-border);
        }
        
        .ribbon-group:last-child {
            border-right: none;
        }
        
        .ribbon-group-title {
            font-size: 11px;
            color: var(--gray);
            text-align: center;
        }
        
        .ribbon-buttons {
            display: flex;
            gap: 8px;
        }
        
        .ribbon-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            color: var(--dark);
        }
        
        .ribbon-button:hover {
            background-color: var(--light);
        }
        
        .ribbon-button i {
            font-size: 16px;
        }
        
        main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .sidebar {
            width: 280px;
            background-color: white;
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .sidebar-section {
            padding: 16px;
            border-bottom: 1px solid var(--border);
        }
        
        .sidebar-section h2 {
            font-size: 14px;
            font-weight: 500;
            color: var(--gray);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .user-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .user-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 6px;
            border-radius: 4px;
        }
        
        .user-item:hover {
            background-color: var(--light);
        }
        
        .user-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary);
            margin-left: auto;
        }
        
        .user-status.idle {
            background-color: #fbbc05;
        }
        
        .user-status.offline {
            background-color: var(--gray);
        }
        
        .admin-badge {
            background-color: var(--primary);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
        }
        
        .version-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            overflow-y: auto;
            flex: 1;
            padding: 8px;
        }
        
        .version-item {
            padding: 12px;
            border-radius: 6px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .version-item:hover {
            background-color: var(--light);
        }
        
        .version-item.active {
            border-color: var(--primary);
            background-color: rgba(37, 100, 207, 0.1);
        }
        
        .version-title {
            font-weight: 500;
            margin-bottom: 4px;
            font-size: 14px;
        }
        
        .version-meta {
            font-size: 12px;
            color: var(--gray);
            display: flex;
            justify-content: space-between;
        }
        
        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background-color: white;
        }
        
        .editor-header {
            padding: 12px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
        }
        
        .document-title {
            font-size: 16px;
            font-weight: 500;
        }
        
        .editor-actions {
            display: flex;
            gap: 12px;
        }
        
        .editor-body {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .document-editor {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .document-editor:focus {
            outline: none;
        }
        
        .branch-panel {
            width: 280px;
            border-left: 1px solid var(--border);
            padding: 16px;
            overflow-y: auto;
            background-color: white;
        }
        
        .branch-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .branch-header h2 {
            font-size: 16px;
            font-weight: 500;
        }
        
        .branch-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .branch-item {
            padding: 12px;
            border-radius: 6px;
            border: 1px solid var(--border);
            cursor: pointer;
        }
        
        .branch-item.active {
            border-color: var(--primary);
            background-color: rgba(37, 100, 207, 0.1);
        }
        
        .branch-name {
            font-weight: 500;
            margin-bottom: 4px;
            font-size: 14px;
        }
        
        .branch-meta {
            font-size: 12px;
            color: var(--gray);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 8px;
            padding: 24px;
            width: 500px;
            max-width: 90%;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 500;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--gray);
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--gray);
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 14px;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 24px;
        }
        
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            padding: 12px 20px;
            background-color: var(--dark);
            color: white;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .suggestion-box {
            position: absolute;
            background: white;
            border: 1px solid var(--border);
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            display: none;
        }
        
        .suggestion-item {
            padding: 8px 12px;
            cursor: pointer;
        }
        
        .suggestion-item:hover {
            background-color: var(--light);
        }
        
        .permission-badge {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 4px;
            background-color: var(--light);
            color: var(--gray);
        }
        
        .permission-badge.edit {
            background-color: #e3f2fd;
            color: var(--primary);
        }
        
        .permission-badge.admin {
            background-color: #ffebee;
            color: var(--accent);
        }
        
        .comment-highlight {
            background-color: #fff8e1;
            border-bottom: 2px solid #ffd54f;
        }
        
        .comment {
            margin-top: 8px;
            padding: 8px;
            border-left: 3px solid #2564cf;
            background-color: #f5f5f5;
        }
        
        .comment-author {
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .comment-text {
            font-size: 14px;
        }
        
        .comment-actions {
            margin-top: 4px;
            display: flex;
            justify-content: flex-end;
        }
        
        @media (max-width: 1200px) {
            .branch-panel {
                display: none;
            }
        }
        
        @media (max-width: 992px) {
            .sidebar {
                width: 220px;
            }
            
            .ribbon-content {
                height: 100px;
            }
        }
        
        @media (max-width: 768px) {
            .ribbon-content {
                height: 120px;
                overflow-y: auto;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <div class="logo-icon"><i class="fas fa-file-word"></i></div>
            <h1>CollabDoc</h1>
        </div>
        <div class="header-actions">
            <button class="btn btn-outline" id="save-btn">
                <i class="fas fa-save"></i> Save
            </button>
            <button class="btn btn-primary" id="share-btn">
                <i class="fas fa-share"></i> Share
            </button>
            <div class="user-info">
                <div class="avatar">MP</div>
                <span>Manjunatha P</span>
            </div>
        </div>
    </header>
    
    <!-- Ribbon Menu -->
    <div class="ribbon">
        <div class="ribbon-tabs">
            <div class="ribbon-tab active" data-tab="home">Home</div>
            <div class="ribbon-tab" data-tab="insert">Insert</div>
            <div class="ribbon-tab" data-tab="review">Review</div>
            <div class="ribbon-tab" data-tab="view">View</div>
            <div class="ribbon-tab" data-tab="collaborate">Collaborate</div>
        </div>
    </div>
    
    <div class="ribbon-content active" id="home-tab">
        <div class="ribbon-group">
            <div class="ribbon-group-title">Clipboard</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="paste-btn">
                    <i class="fas fa-paste"></i>
                    <span>Paste</span>
                </div>
                <div class="ribbon-button" id="cut-btn">
                    <i class="fas fa-cut"></i>
                    <span>Cut</span>
                </div>
                <div class="ribbon-button" id="copy-btn">
                    <i class="fas fa-copy"></i>
                    <span>Copy</span>
                </div>
            </div>
        </div>
        <div class="ribbon-group">
            <div class="ribbon-group-title">Editing</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="select-btn">
                    <i class="fas fa-i-cursor"></i>
                    <span>Select</span>
                </div>
                <div class="ribbon-button" id="find-btn">
                    <i class="fas fa-search"></i>
                    <span>Find</span>
                </div>
                <div class="ribbon-button" id="replace-btn">
                    <i class="fas fa-redo"></i>
                    <span>Replace</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="ribbon-content" id="insert-tab">
        <div class="ribbon-group">
            <div class="ribbon-group-title">Pages</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="page-break-btn">
                    <i class="fas fa-file"></i>
                    <span>Page Break</span>
                </div>
                <div class="ribbon-button" id="cover-page-btn">
                    <i class="fas fa-copy"></i>
                    <span>Cover Page</span>
                </div>
            </div>
        </div>
        <div class="ribbon-group">
            <div class="ribbon-group-title">Tables</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="table-btn">
                    <i class="fas fa-table"></i>
                    <span>Table</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="ribbon-content" id="review-tab">
        <div class="ribbon-group">
            <div class="ribbon-group-title">Proofing</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="spelling-btn">
                    <i class="fas fa-check-circle"></i>
                    <span>Spelling</span>
                </div>
                <div class="ribbon-button" id="grammar-btn">
                    <i class="fas fa-theater-masks"></i>
                    <span>Grammar</span>
                </div>
            </div>
        </div>
        <div class="ribbon-group">
            <div class="ribbon-group-title">Changes</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="new-comment-btn">
                    <i class="fas fa-plus"></i>
                    <span>New Comment</span>
                </div>
                <div class="ribbon-button" id="delete-comment-btn">
                    <i class="fas fa-trash"></i>
                    <span>Delete Comment</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="ribbon-content" id="view-tab">
        <div class="ribbon-group">
            <div class="ribbon-group-title">Views</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="print-layout-btn">
                    <i class="fas fa-file-alt"></i>
                    <span>Print Layout</span>
                </div>
                <div class="ribbon-button" id="web-layout-btn">
                    <i class="fas fa-desktop"></i>
                    <span>Web Layout</span>
                </div>
            </div>
        </div>
        <div class="ribbon-group">
            <div class="ribbon-group-title">Zoom</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="zoom-in-btn">
                    <i class="fas fa-search-plus"></i>
                    <span>Zoom In</span>
                </div>
                <div class="ribbon-button" id="zoom-out-btn">
                    <i class="fas fa-search-minus"></i>
                    <span>Zoom Out</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="ribbon-content" id="collaborate-tab">
        <div class="ribbon-group">
            <div class="ribbon-group-title">Share</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="ribbon-share-btn">
                    <i class="fas fa-share"></i>
                    <span>Share Document</span>
                </div>
                <div class="ribbon-button" id="copy-link-btn">
                    <i class="fas fa-link"></i>
                    <span>Copy Link</span>
                </div>
            </div>
        </div>
        <div class="ribbon-group">
            <div class="ribbon-group-title">Version</div>
            <div class="ribbon-buttons">
                <div class="ribbon-button" id="ribbon-history-btn">
                    <i class="fas fa-history"></i>
                    <span>Version History</span>
                </div>
                <div class="ribbon-button" id="manage-branches-btn">
                    <i class="fas fa-code-branch"></i>
                    <span>Manage Branches</span>
                </div>
            </div>
        </div>
    </div>
    
    <main>
        <div class="sidebar">
            <div class="sidebar-section">
                <h2>Collaborators</h2>
                <div class="user-list">
                    <div class="user-item">
                        <div class="avatar">MP</div>
                        <span>Manjunatha P</span>
                        <div class="admin-badge">Admin</div>
                        <div class="user-status"></div>
                    </div>
                    <div class="user-item">
                        <div class="avatar">AA</div>
                        <span>Abhay S Atreya</span>
                        <div class="admin-badge">Admin</div>
                        <div class="user-status idle"></div>
                    </div>
                    <div class="user-item">
                        <div class="avatar">SG</div>
                        <span>Shivaswamy G S</span>
                        <div class="admin-badge">Admin</div>
                        <div class="user-status"></div>
                    </div>
                    <div class="user-item">
                        <div class="avatar">VK</div>
                        <span>Vijay Kumar</span>
                        <div class="admin-badge">Admin</div>
                        <div class="user-status offline"></div>
                    </div>
                    <div class="user-item">
                        <div class="avatar">RJ</div>
                        <span>Rahul J</span>
                        <div class="permission-badge edit">Can Edit</div>
                        <div class="user-status"></div>
                    </div>
                    <div class="user-item">
                        <div class="avatar">PS</div>
                        <span>Priya S</span>
                        <div class="permission-badge">Can View</div>
                        <div class="user-status idle"></div>
                    </div>
                </div>
            </div>
            <div class="sidebar-section">
                <h2>Version History</h2>
                <div class="version-list">
                    <div class="version-item active">
                        <div class="version-title">Current Version</div>
                        <div class="version-meta">
                            <span>Just now</span>
                            <span>Manjunatha P</span>
                        </div>
                    </div>
                    <div class="version-item">
                        <div class="version-title">Updated introduction</div>
                        <div class="version-meta">
                            <span>2 hours ago</span>
                            <span>Abhay S Atreya</span>
                        </div>
                    </div>
                    <div class="version-item">
                        <div class="version-title">Fixed typos</div>
                        <div class="version-meta">
                            <span>Yesterday</span>
                            <span>Shivaswamy G S</span>
                        </div>
                    </div>
                    <div class="version-item">
                        <div class="version-title">Added specifications</div>
                        <div class="version-meta">
                            <span>2 days ago</span>
                            <span>Vijay Kumar</span>
                        </div>
                    </div>
                    <div class="version-item">
                        <div class="version-title">Initial draft</div>
                        <div class="version-meta">
                            <span>3 days ago</span>
                            <span>Manjunatha P</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="editor-container">
            <div class="editor-header">
                <div class="document-title">Project Proposal.docx</div>
                <div class="editor-actions">
                    <button class="btn btn-outline" id="branch-btn">
                        <i class="fas fa-code-branch"></i> Branch
                    </button>
                    <button class="btn btn-outline" id="history-btn">
                        <i class="fas fa-history"></i> History
                    </button>
                    <button class="btn btn-outline" id="merge-btn">
                        <i class="fas fa-code-merge"></i> Merge
                    </button>
                </div>
            </div>
            <div class="editor-body">
                <div class="document-editor" contenteditable="true" id="editor">
                    <h1>Project Proposal: NextGen Collaboration Tool</h1>
                    <p>This document outlines the proposal for a next-generation collaborative document editing platform that will revolutionize how teams work together on content creation.</p>
                    
                    <h2>Introduction</h2>
                    <p>In today's fast-paced work environment, teams often struggle with version control and collaboration on documents. Our solution will provide:</p>
                    <ul>
                        <li>Real-time collaborative editing</li>
                        <li>Advanced version control with branching and merging</li>
                        <li>Seamless integration with existing tools</li>
                        <li>Powerful workflow management features</li>
                    </ul>
                    
                    <h2>Market Opportunity</h2>
                    <p>The market for collaborative tools has grown exponentially since the pandemic, with an estimated market size of $15 billion by 2025.</p>
                    
                    <h2>Technical Approach</h2>
                    <p>We will leverage operational transformation algorithms to handle concurrent edits and conflict resolution. The architecture will be microservices-based for scalability.</p>
                    
                    <h2>Team Members</h2>
                    <p>This project will be developed by our talented team of engineers:</p>
                    <ul>
                        <li>Manjunatha P - Lead Developer</li>
                        <li>Abhay S Atreya - Backend Specialist</li>
                        <li>Shivaswamy G S - Frontend Developer</li>
                        <li>Vijay Kumar - DevOps Engineer</li>
                    </ul>
                </div>
                <div class="suggestion-box" id="suggestion-box"></div>
            </div>
        </div>
        
        <div class="branch-panel">
            <div class="branch-header">
                <h2>Branches</h2>
                <button class="btn btn-primary" id="new-branch-btn">New</button>
            </div>
            <div class="branch-list">
                <div class="branch-item active">
                    <div class="branch-name">main</div>
                    <div class="branch-meta">Latest commit: 2 hours ago</div>
                </div>
                <div class="branch-item">
                    <div class="branch-name">feature/new-ui</div>
                    <div class="branch-meta">By Abhay S Atreya, 1 day ago</div>
                </div>
                <div class="branch-item">
                    <div class="branch-name">bugfix/typos</div>
                    <div class="branch-meta">By Shivaswamy G S, 2 days ago</div>
                </div>
                <div class="branch-item">
                    <div class="branch-name">docs/improvements</div>
                    <div class="branch-meta">By Vijay Kumar, 3 days ago</div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Modals -->
    <div class="modal" id="share-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Share Document</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="form-group">
                <label>Invite people</label>
                <input type="text" class="form-control" placeholder="Enter emails">
            </div>
            <div class="form-group">
                <label>Permission</label>
                <select class="form-control" id="permission-select">
                    <option>Can edit</option>
                    <option>Can comment</option>
                    <option>Can view</option>
                </select>
            </div>
            <div class="form-group">
                <label>Message (optional)</label>
                <textarea class="form-control" placeholder="Add a message"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-share">Cancel</button>
                <button class="btn btn-primary" id="send-invites">Send Invites</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="branch-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create New Branch</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="form-group">
                <label>Branch name</label>
                <input type="text" class="form-control" placeholder="feature/new-feature">
            </div>
            <div class="form-group">
                <label>Based on</label>
                <select class="form-control">
                    <option>main (latest)</option>
                    <option>feature/new-ui</option>
                    <option>bugfix/typos</option>
                    <option>docs/improvements</option>
                </select>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-branch">Cancel</button>
                <button class="btn btn-primary" id="create-branch">Create Branch</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="history-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Document History</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="version-list">
                <div class="version-item">
                    <div class="version-title">Updated technical details</div>
                    <div class="version-meta">
                        <span>10 minutes ago</span>
                        <span>Manjunatha P</span>
                    </div>
                </div>
                <div class="version-item">
                    <div class="version-title">Added market research</div>
                    <div class="version-meta">
                        <span>1 hour ago</span>
                        <span>Abhay S Atreya</span>
                    </div>
                </div>
                <div class="version-item">
                    <div class="version-title">Fixed formatting issues</div>
                    <div class="version-meta">
                        <span>2 hours ago</span>
                        <span>Shivaswamy G S</span>
                    </div>
                </div>
                <div class="version-item">
                    <div class="version-title">Added specifications section</div>
                    <div class="version-meta">
                        <span>Yesterday</span>
                        <span>Vijay Kumar</span>
                    </div>
                </div>
                <div class="version-item">
                    <div class="version-title">Initial draft</div>
                    <div class="version-meta">
                        <span>3 days ago</span>
                        <span>Manjunatha P</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="restore-version">Restore Selected Version</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="find-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Find</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="form-group">
                <label>Find what</label>
                <input type="text" class="form-control" id="find-input" placeholder="Enter text to find">
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-find">Cancel</button>
                <button class="btn btn-primary" id="find-next">Find Next</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="replace-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Find and Replace</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="form-group">
                <label>Find what</label>
                <input type="text" class="form-control" id="replace-find-input" placeholder="Text to find">
            </div>
            <div class="form-group">
                <label>Replace with</label>
                <input type="text" class="form-control" id="replace-with-input" placeholder="Replacement text">
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-replace">Cancel</button>
                <button class="btn btn-primary" id="replace-all">Replace All</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="table-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Insert Table</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="form-group">
                <label>Number of rows</label>
                <input type="number" class="form-control" id="table-rows" value="3" min="1" max="10">
            </div>
            <div class="form-group">
                <label>Number of columns</label>
                <input type="number" class="form-control" id="table-cols" value="3" min="1" max="8">
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-table">Cancel</button>
                <button class="btn btn-primary" id="insert-table">Insert Table</button>
            </div>
        </div>
    </div>
    
    <div class="toast" id="toast">Document saved successfully!</div>
    
    <script>
        // DOM Elements
        const editor = document.getElementById('editor');
        const suggestionBox = document.getElementById('suggestion-box');
        const shareBtn = document.getElementById('share-btn');
        const shareModal = document.getElementById('share-modal');
        const branchBtn = document.getElementById('branch-btn');
        const branchModal = document.getElementById('branch-modal');
        const historyBtn = document.getElementById('history-btn');
        const historyModal = document.getElementById('history-modal');
        const saveBtn = document.getElementById('save-btn');
        const toast = document.getElementById('toast');
        const newBranchBtn = document.getElementById('new-branch-btn');
        const ribbonShareBtn = document.getElementById('ribbon-share-btn');
        const ribbonHistoryBtn = document.getElementById('ribbon-history-btn');
        const ribbonTabs = document.querySelectorAll('.ribbon-tab');
        const ribbonContents = document.querySelectorAll('.ribbon-content');
        const modalCloseButtons = document.querySelectorAll('.modal-close');
        
        // Clipboard buttons
        const pasteBtn = document.getElementById('paste-btn');
        const cutBtn = document.getElementById('cut-btn');
        const copyBtn = document.getElementById('copy-btn');
        
        // Editing buttons
        const selectBtn = document.getElementById('select-btn');
        const findBtn = document.getElementById('find-btn');
        const replaceBtn = document.getElementById('replace-btn');
        
        // Insert buttons
        const pageBreakBtn = document.getElementById('page-break-btn');
        const coverPageBtn = document.getElementById('cover-page-btn');
        const tableBtn = document.getElementById('table-btn');
        
        // Review buttons
        const spellingBtn = document.getElementById('spelling-btn');
        const grammarBtn = document.getElementById('grammar-btn');
        const newCommentBtn = document.getElementById('new-comment-btn');
        const deleteCommentBtn = document.getElementById('delete-comment-btn');
        
        // View buttons
        const printLayoutBtn = document.getElementById('print-layout-btn');
        const webLayoutBtn = document.getElementById('web-layout-btn');
        const zoomInBtn = document.getElementById('zoom-in-btn');
        const zoomOutBtn = document.getElementById('zoom-out-btn');
        
        // Collaborate buttons
        const copyLinkBtn = document.getElementById('copy-link-btn');
        const manageBranchesBtn = document.getElementById('manage-branches-btn');
        
        // Modals
        const findModal = document.getElementById('find-modal');
        const replaceModal = document.getElementById('replace-modal');
        const tableModal = document.getElementById('table-modal');
        
        // State variables
        let currentZoom = 100;
        let currentLayout = 'print';
        let comments = [];
        let selectedText = '';
        let clipboardContent = '';
        
        // Auto-correction dictionary
        const autoCorrectDict = {
            'teh': 'the',
            'adn': 'and',
            'thier': 'their',
            'recieve': 'receive',
            'seperate': 'separate',
            'definately': 'definitely',
            'alot': 'a lot',
            'occured': 'occurred',
            'untill': 'until',
            'wich': 'which'
        };
        
        // Grammar suggestions
        const grammarSuggestions = {
            'i ': 'I ',
            'im': 'I\'m'
        };
        
        // Initialize modals
        function initModals() {
            // Share modal
            shareBtn.addEventListener('click', () => {
                shareModal.classList.add('active');
            });
            
            ribbonShareBtn.addEventListener('click', () => {
                shareModal.classList.add('active');
            });
            
            // Branch modal
            branchBtn.addEventListener('click', () => {
                branchModal.classList.add('active');
            });
            
            // New branch button in panel
            newBranchBtn.addEventListener('click', () => {
                branchModal.classList.add('active');
            });
            
            // History modal
            historyBtn.addEventListener('click', () => {
                historyModal.classList.add('active');
            });
            
            ribbonHistoryBtn.addEventListener('click', () => {
                historyModal.classList.add('active');
            });
            
            // Find modal
            findBtn.addEventListener('click', () => {
                findModal.classList.add('active');
            });
            
            // Replace modal
            replaceBtn.addEventListener('click', () => {
                replaceModal.classList.add('active');
            });
            
            // Table modal
            tableBtn.addEventListener('click', () => {
                tableModal.classList.add('active');
            });
            
            // Close modals
            modalCloseButtons.forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.classList.remove('active');
                    });
                });
            });
            
            // Cancel buttons
            document.getElementById('cancel-share').addEventListener('click', () => {
                shareModal.classList.remove('active');
            });
            
            document.getElementById('cancel-branch').addEventListener('click', () => {
                branchModal.classList.remove('active');
            });
            
            document.getElementById('cancel-find').addEventListener('click', () => {
                findModal.classList.remove('active');
            });
            
            document.getElementById('cancel-replace').addEventListener('click', () => {
                replaceModal.classList.remove('active');
            });
            
            document.getElementById('cancel-table').addEventListener('click', () => {
                tableModal.classList.remove('active');
            });
            
            // Create branch
            document.getElementById('create-branch').addEventListener('click', () => {
                showToast('New branch created successfully!');
                branchModal.classList.remove('active');
            });
            
            // Send invites
            document.getElementById('send-invites').addEventListener('click', () => {
                showToast('Invitations sent successfully!');
                shareModal.classList.remove('active');
            });
            
            // Restore version
            document.getElementById('restore-version').addEventListener('click', () => {
                showToast('Version restored successfully!');
                historyModal.classList.remove('active');
            });
            
            // Find next
            document.getElementById('find-next').addEventListener('click', () => {
                const searchText = document.getElementById('find-input').value;
                if (searchText) {
                    findText(searchText);
                }
            });
            
            // Replace all
            document.getElementById('replace-all').addEventListener('click', () => {
                const findText = document.getElementById('replace-find-input').value;
                const replaceText = document.getElementById('replace-with-input').value;
                if (findText && replaceText) {
                    replaceAllText(findText, replaceText);
                    replaceModal.classList.remove('active');
                }
            });
            
            // Insert table
            document.getElementById('insert-table').addEventListener('click', () => {
                const rows = parseInt(document.getElementById('table-rows').value);
                const cols = parseInt(document.getElementById('table-cols').value);
                if (rows > 0 && cols > 0) {
                    insertTable(rows, cols);
                    tableModal.classList.remove('active');
                }
            });
        }
        
        // Initialize ribbon tabs
        function initRibbonTabs() {
            ribbonTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    
                    // Update active tab
                    ribbonTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Show corresponding content
                    ribbonContents.forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabName}-tab`).classList.add('active');
                });
            });
        }
        
        // Initialize button functionality
        function initButtons() {
            // Clipboard buttons
            pasteBtn.addEventListener('click', handlePaste);
            cutBtn.addEventListener('click', handleCut);
            copyBtn.addEventListener('click', handleCopy);
            
            // Editing buttons
            selectBtn.addEventListener('click', handleSelectAll);
            
            // Insert buttons
            pageBreakBtn.addEventListener('click', insertPageBreak);
            coverPageBtn.addEventListener('click', insertCoverPage);
            
            // Review buttons
            spellingBtn.addEventListener('click', checkSpelling);
            grammarBtn.addEventListener('click', checkGrammar);
            newCommentBtn.addEventListener('click', addNewComment);
            deleteCommentBtn.addEventListener('click', deleteComment);
            
            // View buttons
            printLayoutBtn.addEventListener('click', () => switchLayout('print'));
            webLayoutBtn.addEventListener('click', () => switchLayout('web'));
            zoomInBtn.addEventListener('click', zoomIn);
            zoomOutBtn.addEventListener('click', zoomOut);
            
            // Collaborate buttons
            copyLinkBtn.addEventListener('click', copyDocumentLink);
            manageBranchesBtn.addEventListener('click', manageBranches);
            
            // Save button
            saveBtn.addEventListener('click', () => {
                showToast('Document saved successfully!');
            });
        }
        
        // Clipboard functions
        function handlePaste() {
            if (clipboardContent) {
                document.execCommand('insertText', false, clipboardContent);
                showToast('Content pasted');
            } else {
                navigator.clipboard.readText()
                    .then(text => {
                        document.execCommand('insertText', false, text);
                        showToast('Content pasted from clipboard');
                    })
                    .catch(err => {
                        showToast('Failed to paste from clipboard');
                    });
            }
        }
        
        function handleCut() {
            if (window.getSelection().toString()) {
                clipboardContent = window.getSelection().toString();
                document.execCommand('cut');
                showToast('Content cut to clipboard');
            } else {
                showToast('No text selected to cut');
            }
        }
        
        function handleCopy() {
            if (window.getSelection().toString()) {
                clipboardContent = window.getSelection().toString();
                document.execCommand('copy');
                showToast('Content copied to clipboard');
            } else {
                showToast('No text selected to copy');
            }
        }
        
        // Editing functions
        function handleSelectAll() {
            const range = document.createRange();
            range.selectNodeContents(editor);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            showToast('All content selected');
        }
        
        function findText(text) {
            const editorContent = editor.innerHTML;
            const regex = new RegExp(text, 'gi');
            const highlightedContent = editorContent.replace(regex, match => 
                `<span class="comment-highlight">${match}</span>`
            );
            editor.innerHTML = highlightedContent;
            showToast(`Found ${(editorContent.match(regex) || []).length} occurrences`);
        }
        
        function replaceAllText(find, replace) {
            const editorContent = editor.innerHTML;
            const regex = new RegExp(find, 'g');
            const newContent = editorContent.replace(regex, replace);
            editor.innerHTML = newContent;
            showToast('All occurrences replaced');
        }
        
        // Insert functions
        function insertPageBreak() {
            document.execCommand('insertHTML', false, '<div style="page-break-after: always; border-top: 1px dashed #ccc; margin: 20px 0;"><span style="color: #999; font-size: 12px;">--- Page Break ---</span></div>');
            showToast('Page break inserted');
        }
        
        function insertCoverPage() {
            const coverPageHTML = `
                <div style="text-align: center; margin: 100px 0; border: 2px solid #2564cf; padding: 50px; background: #f3f3f3;">
                    <h1 style="color: #2564cf; font-size: 36px;">Project Proposal</h1>
                    <h2 style="color: #5f6368; font-size: 24px;">NextGen Collaboration Tool</h2>
                    <p style="margin-top: 100px; color: #5f6368;">Date: ${new Date().toLocaleDateString()}</p>
                    <p style="color: #5f6368;">Author: CollabDoc Team</p>
                </div>
            `;
            document.execCommand('insertHTML', false, coverPageHTML);
            showToast('Cover page inserted');
        }
        
        function insertTable(rows, cols) {
            let tableHTML = '<table style="width: 100%; border-collapse: collapse; margin: 10px 0;">';
            for (let i = 0; i < rows; i++) {
                tableHTML += '<tr>';
                for (let j = 0; j < cols; j++) {
                    tableHTML += `<td style="border: 1px solid #ddd; padding: 8px;">&nbsp;</td>`;
                }
                tableHTML += '</tr>';
            }
            tableHTML += '</table>';
            document.execCommand('insertHTML', false, tableHTML);
            showToast(`Table inserted (${rows}x${cols})`);
        }
        
        // Review functions
        function checkSpelling() {
            showToast('Spelling check completed. No errors found.');
        }
        
        function checkGrammar() {
            showToast('Grammar check completed. No errors found.');
        }
        
        function addNewComment() {
            const selection = window.getSelection();
            if (selection.toString().trim() === '') {
                showToast('Please select text to comment on');
                return;
            }
            
            const range = selection.getRangeAt(0);
            const selectedText = selection.toString();
            
            // Highlight the selected text
            const span = document.createElement('span');
            span.className = 'comment-highlight';
            span.textContent = selectedText;
            range.deleteContents();
            range.insertNode(span);
            
            // Add comment
            const commentId = 'comment-' + Date.now();
            span.id = commentId;
            
            const comment = {
                id: commentId,
                text: selectedText,
                author: 'Manjunatha P',
                timestamp: new Date().toLocaleString(),
                content: 'New comment'
            };
            
            comments.push(comment);
            
            // Insert comment element
            const commentElement = document.createElement('div');
            commentElement.className = 'comment';
            commentElement.innerHTML = `
                <div class="comment-author">${comment.author} - ${comment.timestamp}</div>
                <div class="comment-text" contenteditable="true">${comment.content}</div>
                <div class="comment-actions">
                    <button class="btn btn-outline" style="font-size: 12px;" onclick="deleteCommentById('${commentId}')">Delete</button>
                </div>
            `;
            
            editor.parentNode.insertBefore(commentElement, editor.nextSibling);
            
            showToast('Comment added');
        }
        
        function deleteComment() {
            if (comments.length === 0) {
                showToast('No comments to delete');
                return;
            }
            
            // Remove the last comment for demo purposes
            const lastComment = comments.pop();
            const commentElement = document.getElementById(lastComment.id);
            if (commentElement) {
                commentElement.classList.remove('comment-highlight');
                commentElement.id = '';
            }
            
            // Remove comment elements (simplified for demo)
            const commentElements = document.querySelectorAll('.comment');
            if (commentElements.length > 0) {
                commentElements[commentElements.length - 1].remove();
            }
            
            showToast('Comment deleted');
        }
        
        function deleteCommentById(commentId) {
            const index = comments.findIndex(c => c.id === commentId);
            if (index !== -1) {
                comments.splice(index, 1);
                
                const commentElement = document.getElementById(commentId);
                if (commentElement) {
                    commentElement.classList.remove('comment-highlight');
                    commentElement.id = '';
                }
                
                // In a real implementation, we would need to map comment elements to comments
                const commentElements = document.querySelectorAll('.comment');
                if (commentElements.length > index) {
                    commentElements[index].remove();
                }
                
                showToast('Comment deleted');
            }
        }
        
        // View functions
        function switchLayout(layout) {
            currentLayout = layout;
            if (layout === 'print') {
                document.body.style.fontFamily = "'Times New Roman', serif";
                editor.style.backgroundColor = '#f9f9f9';
                showToast('Switched to print layout');
            } else {
                document.body.style.fontFamily = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
                editor.style.backgroundColor = 'white';
                showToast('Switched to web layout');
            }
        }
        
        function zoomIn() {
            if (currentZoom < 150) {
                currentZoom += 10;
                editor.style.fontSize = (currentZoom / 100) + 'em';
                showToast(`Zoom: ${currentZoom}%`);
            }
        }
        
        function zoomOut() {
            if (currentZoom > 50) {
                currentZoom -= 10;
                editor.style.fontSize = (currentZoom / 100) + 'em';
                showToast(`Zoom: ${currentZoom}%`);
            }
        }
        
        // Collaborate functions
        function copyDocumentLink() {
            navigator.clipboard.writeText(window.location.href)
                .then(() => {
                    showToast('Document link copied to clipboard');
                })
                .catch(err => {
                    showToast('Failed to copy link');
                });
        }
        
        function manageBranches() {
            showToast('Branch management opened');
            // In a real app, this would open a branch management interface
        }
        
        // Show toast notification
        function showToast(message) {
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Auto-correction functionality
        editor.addEventListener('input', (e) => {
            const text = editor.textContent;
            const words = text.split(' ');
            const lastWord = words[words.length - 2]; // Get the last completed word
            
            if (lastWord && autoCorrectDict[lastWord.toLowerCase()]) {
                const correctedWord = autoCorrectDict[lastWord.toLowerCase()];
                const correctedText = text.replace(new RegExp(lastWord + ' ', 'i'), correctedWord + ' ');
                editor.textContent = correctedText;
                
                // Move cursor to end
                const range = document.createRange();
                const selection = window.getSelection();
                range.selectNodeContents(editor);
                range.collapse(false);
                selection.removeAllRanges();
                selection.addRange(range);
            }
        });
        
        // Grammar suggestion functionality
        editor.addEventListener('keypress', (e) => {
            if (e.key === ' ') {
                const text = editor.textContent;
                const lastTwoChars = text.substring(text.length - 2);
                
                if (grammarSuggestions[lastTwoChars.toLowerCase()]) {
                    const suggestion = grammarSuggestions[lastTwoChars.toLowerCase()];
                    showSuggestion(suggestion, editor);
                }
            }
        });
        
        // Show suggestion box
        function showSuggestion(suggestion, element) {
            const rect = element.getBoundingClientRect();
            suggestionBox.textContent = '';
            
            const suggestionItem = document.createElement('div');
            suggestionItem.className = 'suggestion-item';
            suggestionItem.textContent = `Suggest: ${suggestion}`;
            
            suggestionItem.addEventListener('click', () => {
                const text = editor.textContent;
                const newText = text.substring(0, text.length - 2) + suggestion;
                editor.textContent = newText;
                suggestionBox.style.display = 'none';
            });
            
            suggestionBox.appendChild(suggestionItem);
            suggestionBox.style.display = 'block';
            suggestionBox.style.top = `${rect.bottom}px`;
            suggestionBox.style.left = `${rect.left}px`;
        }
        
        // Hide suggestion box when clicking elsewhere
        document.addEventListener('click', (e) => {
            if (e.target !== editor) {
                suggestionBox.style.display = 'none';
            }
        });
        
        // Initialize the application
        function init() {
            initModals();
            initRibbonTabs();
            initButtons();
            
            // Simulate real-time collaboration (for demo purposes)
            simulateCollaboration();
        }
        
        // Simulate real-time collaboration
        function simulateCollaboration() {
            setInterval(() => {
                const admins = [
                    {name: 'Abhay S Atreya', initial: 'AA'},
                    {name: 'Shivaswamy G S', initial: 'SG'},
                    {name: 'Vijay Kumar', initial: 'VK'}
                ];
                const randomAdmin = admins[Math.floor(Math.random() * admins.length)];
                const activities = [
                    'is editing the introduction',
                    'is updating the technical specifications',
                    'is reviewing the market analysis',
                    'is fixing typos',
                    'is adding new content'
                ];
                const randomActivity = activities[Math.floor(Math.random() * activities.length)];
                
                // For demo purposes, we're just showing a toast
                if (Math.random() > 0.7) {
                    showToast(`${randomAdmin.name} ${randomActivity}`);
                }
            }, 10000);
        }
        
        // Make deleteCommentById available globally for the comment delete buttons
        window.deleteCommentById = deleteCommentById;
        
        // Initialize the app
        init();
    </script>
</body>
</html>